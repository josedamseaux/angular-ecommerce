{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/josed/Escritorio/WebDev/1 ANGULAR/frontEcommerceAngular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet AdminPanelComponent = class AdminPanelComponent {\n  onInputChange() {\n    console.log(this.searchValue);\n  }\n  constructor(authService, productService, usersService, http) {\n    this.authService = authService;\n    this.productService = productService;\n    this.usersService = usersService;\n    this.http = http;\n    this.usersData = {\n      users: [],\n      totalCount: 0,\n      totalPages: 0\n    };\n    this.currentPage = 1;\n    this.product = {\n      productName: '',\n      description: '',\n      totalAmount: 0,\n      quantity: 0\n    };\n    this.imgs = [];\n    this.selectedFile = null;\n    this.searchValue = '';\n    this.getData();\n    this.productAddedSubscription = this.productService.onProductChange().subscribe(() => {\n      this.getData();\n    });\n  }\n  deletePurchase(id) {\n    console.log(id);\n    // {{localhost}}/purchases/delete-purchase-by-id/:id\n    return this.http.post(`http://localhost:8000/api/purchases/delete-purchase-by-id`, {\n      items: itemId\n    }, {\n      headers\n    }).subscribe(data => {\n      console.log(data);\n      this.getIdsFromItemsFromShoppingCart();\n    });\n  }\n  onKey(event) {\n    this.searchValue = event.target.value;\n    console.log(this.searchValue);\n  }\n  ngOnInit() {\n    this.getUsers(this.currentPage);\n  }\n  deleteItem(i) {\n    this.productService.deleteItem(i);\n  }\n  onFileSelected(event) {\n    this.selectedFile = event.target.files[0];\n  }\n  getData() {\n    this.imgs = [];\n    this.productService.getProducts().subscribe(reso => {\n      this.response = reso;\n      reso.forEach(element => {\n        const base64Image = this.productService.arrayBufferToBase64(element.imageData.data);\n        element.imges = ['data:' + element.imageData.type + ';base64,' + base64Image];\n      });\n    });\n  }\n  onSubmit(form) {\n    if (form.valid && this.selectedFile) {\n      this.productService.addProduct(this.product, this.selectedFile).subscribe(response => {\n        form.reset();\n        if (response) {\n          console.log('Producto agregado exitosamente:', response);\n        }\n      });\n    }\n  }\n  getUsers(page) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const data = yield _this.usersService.getUsers(page).toPromise();\n      console.log(data);\n      _this.usersData.users = data.users;\n      _this.usersData.totalCount = data.totalCount;\n      _this.usersData.totalPages = data.totalPages;\n    })();\n  }\n  findUserAndPurchases() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      console.log(_this2.searchValue);\n      if (_this2.searchValue === '') {\n        _this2.userFound = [];\n      }\n      const data = yield _this2.usersService.findUserAndPurchases(_this2.searchValue).toPromise();\n      _this2.userFound = data;\n      console.log(data);\n    })();\n  }\n  clickOnUser(i) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      const data = yield _this3.usersService.findUserAndPurchases(i.username).toPromise();\n      _this3.userFound = data;\n    })();\n  }\n  getPageNumbers() {\n    return Array.from({\n      length: this.usersData.totalPages\n    }, (_, i) => i + 1);\n  }\n  goToPage(pageNumber) {\n    this.currentPage = pageNumber;\n    this.getUsers(this.currentPage);\n  }\n  ngOnDestroy() {\n    this.productAddedSubscription.unsubscribe();\n  }\n};\nAdminPanelComponent = __decorate([Component({\n  selector: 'app-admin-panel',\n  templateUrl: './admin-panel.component.html',\n  styleUrls: ['./admin-panel.component.css']\n})], AdminPanelComponent);\nexport { AdminPanelComponent };","map":{"version":3,"names":["Component","AdminPanelComponent","onInputChange","console","log","searchValue","constructor","authService","productService","usersService","http","usersData","users","totalCount","totalPages","currentPage","product","productName","description","totalAmount","quantity","imgs","selectedFile","getData","productAddedSubscription","onProductChange","subscribe","deletePurchase","id","post","items","itemId","headers","data","getIdsFromItemsFromShoppingCart","onKey","event","target","value","ngOnInit","getUsers","deleteItem","i","onFileSelected","files","getProducts","reso","response","forEach","element","base64Image","arrayBufferToBase64","imageData","imges","type","onSubmit","form","valid","addProduct","reset","page","_this","_asyncToGenerator","toPromise","findUserAndPurchases","_this2","userFound","clickOnUser","_this3","username","getPageNumbers","Array","from","length","_","goToPage","pageNumber","ngOnDestroy","unsubscribe","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\josed\\Escritorio\\WebDev\\1 ANGULAR\\frontEcommerceAngular\\src\\app\\admin-panel\\admin-panel.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ProductService } from '../services/product.service';\nimport { ProductInterface } from '../interfaces/product.interface';\nimport { Subscription } from 'rxjs';\nimport { UsersService } from '../services/users.service';\nimport { HttpClient } from '@angular/common/http';\n\n@Component({\n  selector: 'app-admin-panel',\n  templateUrl: './admin-panel.component.html',\n  styleUrls: ['./admin-panel.component.css']\n})\nexport class AdminPanelComponent implements OnInit {\n\n  usersData: any = {\n    users: [],\n    totalCount: 0,\n    totalPages: 0,\n  };\n  currentPage: number = 1;\n\n  product: ProductInterface = {\n    productName: '',\n    description: '',\n    totalAmount: 0,\n    quantity: 0\n  };\n\n  response: any;\n\n  imgs: any[] = [];\n\n  selectedFile: File | null = null;\n\n  private productAddedSubscription: Subscription;\n\n  searchValue: string = ''\n\n  userFound: any | undefined;\n\n  onInputChange() {\n    console.log(this.searchValue);\n  };\n\n  constructor(private authService: AuthService, private productService: ProductService, private usersService: UsersService, private http: HttpClient) {\n    this.getData();\n    this.productAddedSubscription = this.productService.onProductChange().subscribe(() => {\n      this.getData();\n    });\n  }\n\n  deletePurchase(id: string){\n    console.log(id)\n\n    // {{localhost}}/purchases/delete-purchase-by-id/:id\n\n    return this.http.post<any>(`http://localhost:8000/api/purchases/delete-purchase-by-id`, { items: itemId }, { headers }).subscribe(data => {\n      console.log(data)\n      this.getIdsFromItemsFromShoppingCart()\n    })\n  }\n\n  onKey(event: any) {\n    this.searchValue = event.target.value;\n    console.log(this.searchValue)\n  }\n\n  ngOnInit(): void {\n    this.getUsers(this.currentPage);\n  }\n\n  deleteItem(i: any) {\n    this.productService.deleteItem(i)\n  }\n\n  onFileSelected(event: any) {\n    this.selectedFile = event.target.files[0];\n  }\n\n  getData() {\n    this.imgs = [];\n    this.productService.getProducts().subscribe((reso: any) => {\n      this.response = reso;\n      reso.forEach((element: any) => {\n        const base64Image = this.productService.arrayBufferToBase64(element.imageData.data);\n        element.imges = ['data:' + element.imageData.type + ';base64,' + base64Image];\n      });\n    });\n  }\n\n  onSubmit(form: any) {\n    if (form.valid && this.selectedFile) {\n      this.productService.addProduct(this.product, this.selectedFile)\n        .subscribe(response => {\n          form.reset();\n          if (response) {\n            console.log('Producto agregado exitosamente:', response);\n          }\n        });\n    }\n  }\n\n  async getUsers(page: number) {\n    const data: any = await this.usersService.getUsers(page).toPromise();\n    console.log(data);\n    this.usersData.users = data.users;\n    this.usersData.totalCount = data.totalCount;\n    this.usersData.totalPages = data.totalPages;\n  }\n\n  async findUserAndPurchases() {\n    console.log(this.searchValue)\n\n    if(this.searchValue === ''){\n      this.userFound = []\n    }\n    const data: any = await this.usersService.findUserAndPurchases(this.searchValue).toPromise()\n    this.userFound = data\n    console.log(data);\n  }\n\n  async clickOnUser(i: any){\n    const data: any = await this.usersService.findUserAndPurchases(i.username).toPromise()\n    this.userFound = data\n  }\n\n  getPageNumbers(): number[] {\n    return Array.from({ length: this.usersData.totalPages }, (_, i) => i + 1);\n  }\n\n  goToPage(pageNumber: number): void {\n    this.currentPage = pageNumber;\n    this.getUsers(this.currentPage);\n  }\n\n  ngOnDestroy() {\n    this.productAddedSubscription.unsubscribe();\n  }\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}